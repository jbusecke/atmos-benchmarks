#!/usr/bin/env bash
################################################################################
# Isentropic surface interpolation as function of file size
################################################################################
source header.sh
for data in ${datas[@]}; do
  # Header
  printhead $data

  # Python with MetPy method
  bench "MetPy" python ${name}.py $data 0

  # Python with MetPy method
  bench "MetPy + Dask" python ${name}.py $data 10

  # NCL method
  # NOTE: NCL needs special dyld library path but so does brew, screws
  # up Homebrew if we set it, so set it locally
  export DYLD_LIBRARY_PATH="/usr/local/lib/gcc/4.9"
  bench "NCL" ncl -Q -n "filename=\"$data\"" "outname=\"${data%/*}/isentropes_ncl.nc\"" ${name}.ncl
  export DYLD_LIBRARY_PATH=""

  # NCL in parallel by splitting timesteps with ncks
  # export DYLD_LIBRARY_PATH="/usr/local/lib/gcc/4.9"
  # bench "NCL Parallel" nclparallel "$data"
  # export DYLD_LIBRARY_PATH=""
done
